<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
         <!-- Required meta tags-->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <meta name="format-detection" content="telephone=no">
        <meta name="msapplication-tap-highlight" content="no">

        <title>DoeFy</title>

        <link rel="stylesheet" href="lib/framework7/css/framework7.ios.min.css">
        <link rel="stylesheet" href="lib/framework7/css/framework7.ios.colors.min.css">

        <link rel="stylesheet" href="css/styles.css">


        <script src="https://www.gstatic.com/firebasejs/4.8.1/firebase.js"></script>


        <script src="https://www.gstatic.com/firebasejs/5.0.1/firebase.js"></script>
        <link rel="stylesheet" type="text/css" href="css/style.css">
        <script type="text/javascript" src="cordova.js"></script>

        <script>
          // Initialize Firebase
          var config = {
            apiKey: "AIzaSyBYDbtUQYpG5fp5CjGFfy93g4dYfvzdano",
            authDomain: "doefyteste.firebaseapp.com",
            databaseURL: "https://doefyteste.firebaseio.com",
            projectId: "doefyteste",
            storageBucket: "",
            messagingSenderId: "879796181995"
          };
          firebase.initializeApp(config);
          var database = firebase.database();

            var db;
            window.onload = function()
            {
             document.getElementById('btnCadastrarDoador').addEventListener('click', verificaCadastroDoador);

            }

            function verificaCadastroDoador(e)
            {
                var name = document.getElementById('nomeDoador').value;
                var email = document.getElementById('emailDoadorCadastro').value;
                var sexo = document.getElementById('sexoDoador').value;
                var dataNascimento = document.getElementById('dataDeNascimentoDoador').value;
                var senha = document.getElementById('senhaDoadorCadastro').value;

                if((name=="")||(email=="")||(sexo=="") || (dataNascimento=="") || (senha="")){
                    document.getElementById('labelErroCadastroDoador').innerHTML = "Preencha todos os campos"
                }
                else{
                    createAccount()
                }

            }


firebase.auth().onAuthStateChanged(function (user) {
    if (user) {
      var uuid = user.uid;
      var sexo = document.getElementById('sexoDoador').value;
      var dataNascimento = document.getElementById('dataDeNascimentoDoador').value;

      var promise = firebase.database().ref('users/' + uuid).set({
                                  name: document.getElementById('nomeDoador').value,
                                  email: document.getElementById('emailDoadorCadastro').value,
                                  sexo: document.getElementById('sexoDoador').value,
                                  dataNascimento: document.getElementById('dataDeNascimentoDoador').value,

                              }, function(error) {
                                  if (error) {
                                      alert("Ops...problemas ao salvar os dados.");

                                    }
                                    else{
                                      window.location.href = "doadorhome.html";
                                      alert("Cadastro Realizado");
                                    }
                                  });


        // User is signed in.

        //document.getElementById("user_div").style.display = "initial";
      //  document.getElementById("login_div").style.display = "none";


}
});

function createAccount() {

    var userEmail = document.getElementById("emailDoadorCadastro").value;
    var userPass = document.getElementById("senhaDoadorCadastro").value;

    firebase.auth().createUserWithEmailAndPassword(userEmail, userPass).catch(function (error) {
        // Handle Errors here.
        var errorCode = error.code;
        var errorMessage = error.message;

        window.alert("Error : " + errorMessage);

        // ...
    });

}

</script>


    </head>

  <body>

<!-- Page, data-page contains page name-->
          <div data-page="cadastroDoador" class="page">
<div class="page" data-name="home">
            <div style="background: #4caf50; height: 40px;">
              
            </div>
            <!-- Scrollable page content-->
            <div class="page-content">
              <div class="list-block">

           

<div class="titulo">faça seu cadastro</div>

<div class="list no-hairlines-md" style="margin-top: 10px">
  <ul>
    <li class="item-content item-input">
      <div class="item-inner">
        <div class="item-input-wrap">
          <input type="text" placeholder="Nome completo" id="nomeDoador">
          <span class="input-clear-button"></span>
        </div>
      </div>
    </li>
     <li class="item-content item-input">
      <div class="item-inner">
        <div class="item-input-wrap">
          <input type="date" value="2018-01-01"  placeholder="Data de nascimento" id="dataDeNascimentoDoador">
          <span class="input-clear-button"></span>
        </div>
      </div>
    </li>
      <li class="item-content item-input">
      <div class="item-inner">
        <div class="item-input-wrap">
          <input type="text" placeholder="Sexo" id="sexoDoador">
          <span class="input-clear-button"></span>
        </div>
      </div>
    </li>
   
    <li class="item-content item-input">
      <div class="item-inner">
        <div class="item-input-wrap">
          <input type="email" placeholder="E-mail" id="emailDoadorCadastro">
          <span class="input-clear-button"></span>
        </div>
      </div>
    </li>
     <li class="item-content item-input">
      <div class="item-inner">
        <div class="item-input-wrap">
          <input type="password" placeholder="Senha" id="senhaDoadorCadastro">
          <span class="input-clear-button"></span>
        </div>
      </div>
    </li>
  </ul>
  <div style="margin-top: 20px">
      <button style="width: 250px; height: 50px; display: block; margin-top: 80px;margin: 0 auto;" id="btnCadastrarDoador" class="col button  button-round color-green" >Cadastrar</button>

  </div>
  
</div>

    <div class="titulo">ou faça login</div>
    <a href="" onclick="location.href='loginDoador.html'"  style="text-align:center;display:block;">Já sou cadastrado</a>

     
    

    <!-- REFERENCE SCRIPTS-->
    <script type="text/javascript" src="assets/js/framework7.min.js"></script>
    <script type="text/javascript" src="assets/js/main.js"></script>
  </body>
</html>
